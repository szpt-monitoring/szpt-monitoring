function drawDashboard(sheetData) {
    const data = new google.visualization.DataTable();
    data.addColumn('string', 'Дата');
    data.addColumn('string', 'Товар');
    data.addColumn('number', 'Рост цен (%)');
    data.addColumn({type: 'string', role: 'style'}); // Колонка для стиля

    console.log('Ищем данные РК в целом...'); // Проверка в консоли

    let rkValue = 0; // Для хранения значения строки "РК в целом"
    sheetData.slice(1).forEach(row => {
        if (row[1] === 'РК в целом') {
            rkValue = parseFloat(row[2]) || 0;
        }
    });

    console.log('Значение РК в целом:', rkValue); // Проверка значения РК в целом

    // Заполняем данные для графика
    sheetData.slice(1).forEach(row => {
        if (row[1] && row[2] !== undefined) {
            const date = row[0]; // Дата
            const value = parseFloat(row[2]) || 0;
            const product = row[1]; // Товар
            let color = 'green'; // Значения ниже "РК в целом" - зелёный

            if (product === 'РК в целом') {
                color = 'blue'; // "РК в целом" - синий
            } else if (value > rkValue) {
                color = 'red'; // Значения выше "РК в целом" - красный
            }

            console.log(`Добавляем строку: ${date}, ${product}, ${value}, ${color}`); // Лог строки
            data.addRow([date, product, value, `color: ${color}`]);
        }
    });

    // Проверка готовых данных
    console.log('Финальные данные для графика:', data);

    // Создание дашборда
    const dashboard = new google.visualization.Dashboard(document.getElementById('dashboard'));

    const dateFilter = new google.visualization.ControlWrapper({
        controlType: 'CategoryFilter',
        containerId: 'filter_div',
        options: {
            filterColumnIndex: 0,
            ui: {
                label: 'Выберите дату',
                allowTyping: false,
                allowMultiple: false
            }
        }
    });

    const barChart = new google.visualization.ChartWrapper({
        chartType: 'BarChart',
        containerId: 'bar_chart',
        options: {
            title: 'Рост цен на СЗПТ с начала года, %',
            hAxis: {title: 'Рост цен (%)', minValue: 0, textStyle: {fontSize: 12}},
            vAxis: {title: 'Товары', textStyle: {fontSize: 8}},
            legend: {position: 'none'},
            bars: 'horizontal',
            height: 900,
            width: 700,
            bar: {groupWidth: '80%'}
        }
    });

    dashboard.bind(dateFilter, barChart);
    dashboard.draw(data);
}
